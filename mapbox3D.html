<!doctypehtml><html lang=en><meta charset=utf-8><title>enfarm 3D viewer</title><meta content="initial-scale=1,maximum-scale=1,user-scalable=no"name=viewport><link href=https://i.ibb.co/tQDxF41/enfarm-favicon.png rel=icon type=image/png><link href=https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css rel=stylesheet><script src=https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js></script><link href="https://fonts.googleapis.com/css2?family=Be+Vietnam:wght@400;500;600;700&display=swap"rel=stylesheet><link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js></script><script src=https://cdn.jsdelivr.net/npm/chart.js></script><script src=https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js crossorigin=anonymous integrity="sha256-8BDDxChCyYOB80/6VhOpmr7qI5EIDyDPzxsWePPFVfo="></script><script src=https://kit.fontawesome.com/0eb73cfc5c.js crossorigin=anonymous></script><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css rel=stylesheet><link href=https://cdn-uicons.flaticon.com/uicons-thin-straight/css/uicons-thin-straight.css rel=stylesheet><link href=https://cdn-uicons.flaticon.com/2.4.2/uicons-thin-rounded/css/uicons-thin-rounded.css rel=stylesheet><link href=https://cdn-uicons.flaticon.com/2.4.2/uicons-regular-straight/css/uicons-regular-straight.css rel=stylesheet><link href=./mapbox3Dterrain.css rel=stylesheet><link href=./farmlist.css rel=stylesheet><style>.north-arrow{position:absolute;top:100px;right:20px;width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;z-index:99999}.north-arrow-icon{font-size:48px;text-shadow:0 0 5px rgba(109,109,109,.9);color:#383838}.north-text{position:absolute;top:40px;left:15px;font-size:20px;font-weight:bolder;color:red;text-shadow:0 0 5px rgba(0,0,0,.9)}</style><div id=map><canvas id=rainCanvas></canvas><div id=inset-map></div></div><a href=https://enfarm.com/ target=_blank><img alt="enfarm Logo"src=https://i.ibb.co/LdXsHXJ/enfarm-logo.png class=company-logo3D></a><div class=search-container><input class=search-input id=searchInput oninput=searchFeatures(this.value) placeholder=Search...> <button class=clear-button onclick=clearSearch() style=display:none><span class=material-icons-outlined>close</span></button></div><div class=popup-farmlist id=popup-farmlist><button class=close-farmlist-btn onclick=hideFarmList() style=color:#555>×</button><div class=farmlist-header><div style=display:flex;align-items:center><span class=material-symbols-outlined style=margin-right:4px>psychiatry</span><h3 data-translate="Managed Farms"style=margin:0>Managed Farms</h3></div><div class=sort-dropdown><button class=sortButton id=sort-button data-translate=Sort>Sort   <i class="fi fi-ts-angle-small-down"></i></button><div class=dropdown-content><a href=# data-translate=Status onclick='sortFarmList("status")'>Status</a> <a href=# data-translate="Farm size"onclick='sortFarmList("size")'>Farm size</a> <a href=# data-translate="Last updated"onclick='sortFarmList("lastUpdated")'>Last updated</a> <a href=# data-translate=Name onclick='sortFarmList("name")'>Name</a> <a href=# data-translate=Produce onclick='sortFarmList("produce")'>Produce</a></div></div></div><div class=farm-list-container id=farm-list-container><div class=fetching-data data-translate="Fetching farm data...">Fetching farm data...</div><div class=sorting-message></div></div></div><button class=lang-switch onclick=toggleLanguage() style=margin-right:5px aria-label="Toggle Language"id=lang-switch>VN <i class="fa-earth-asia fa-solid"></i> <span class=tooltip-right data-translate="Switch Language">Switch Language</span></button> <button class=switch2Dmap-button onclick=switch2Dmap()><span class=material-symbols-outlined>2d</span> <span class=tooltip-right data-translate="Switch to 2D Map View">Switch to 2D Map View</span></button> <button class=mapbox3Dterrain-button onclick=switchBasemap()><span class=material-icons-outlined>landscape</span> <span class=tooltip-right data-translate="Switch Basemap">Switch Basemap</span></button> <button class=farmlist-button onclick=toggleFarmList()><span class=material-symbols-outlined>list</span> <span class=tooltip-right data-translate="See lists of managed farms">See lists of managed farms</span></button> <button class=simulationToggle-button onclick=toggleSimulationPanel()><span class=material-symbols-outlined>token</span> <span class=tooltip-right data-translate=Simulation>Simulation</span></button><div class=simulation-buttons-container><button class=animateRotate-button onclick=toggleRotation(this)><span class=material-icons-outlined id=icon>play_circle</span></button> <button class=weatherToggle-button onclick=toggleRainEffect()><span class=material-symbols-outlined>rainy</span></button> <button class=nightToggle-button onclick=toggleNightEffect()><span class=material-symbols-outlined>nights_stay</span></button> <button class=sunsetToggle-button onclick=toggleSunsetEffect()><span class=material-symbols-outlined>wb_twilight</span></button><div class=simulation-panel><span class="material-symbols-outlined icon">token</span><h3 data-translate=Simulate class=simulate-text>Simulate</h3><div class=bottom-animatetext><span data-translate=animate>animate</span></div><div class=bottom-raintext><span data-translate=rain>rain</span></div><div class=bottom-nighttext><span data-translate=night>night</span></div><div class=bottom-sunsettext><span data-translate=sunset>sunset</span></div></div></div><button class=info-button onclick=toggleInfo()><span class=material-icons-outlined>info</span> <span class=tooltip-left data-translate="About the Application">About the Application</span></button><div class=info-box><div class=info-content><div class=info-image></div><p data-translate=About>About<div class=info-logo><img alt="enFarm Logo"src=https://enfarm.com/fd57352e4cea98b4c1fb.jpg style=width:80px;height:auto></div><p data-translate="Map application to track and visualize deployed enfarm devices">Map application to track and visualize deployed enfarm devices</p><button class=dismiss-button onclick=toggleInfo() data-translate=Dismiss>Dismiss</button></div></div><button class=instructions-button id=instructionsButton><span class=material-icons-outlined>mouse</span> <span class=tooltip-left data-translate="Show Instructions">Show Instructions</span></button><div class=instructions-window id=instructions-window><button class=close-button id=closeInstructions><span class=material-icons-outlined>close</span></button><div style=display:flex;align-items:center;margin-bottom:20px;margin-top:10px><span class=material-icons-outlined style=margin-right:5px>mouse</span><h3 data-translate="Navigating the 3D Map"style=font-weight:700;margin:0>Navigating the 3D Map</h3></div><div style=display:flex;align-items:center><div><img alt="Left Mouse Click Icon"src=https://i.ibb.co/dGjF58h/icons8-left-click-96.png style=vertical-align:middle;width:50px;height:50px></div><div style=margin-left:10px><div style=font-weight:700 data-translate="Show farm information">Show farm information</div><div data-translate="Left mouse button click on a farm point">Left mouse button click on a farm point</div></div></div><div style=display:flex;align-items:center;margin-top:10px><div><img alt="Left Mouse Click Icon"src=https://i.ibb.co/dGjF58h/icons8-left-click-96.png style=vertical-align:middle;width:50px;height:50px></div><div style=margin-left:10px><div style=font-weight:700 data-translate="Pan the map">Pan the map</div><div data-translate="Left mouse button click + drag">Left mouse button click + drag</div></div></div><div style=display:flex;align-items:center;margin-top:10px><div style=margin-left:2px><img alt="Mouse Scrolling Icon"src=https://i.ibb.co/9GqDfjw/icons8-mouse-scrolling-96.png style=vertical-align:middle;width:50px;height:50px></div><div style=margin-left:10px><div style=font-weight:700 data-translate="Zoom the map view">Zoom the map view</div><div data-translate="Use the mouse scroll wheel">Use the mouse scroll wheel</div></div></div><div style=display:flex;align-items:center;margin-top:10px><div style=margin-left:6px;margin-right:10px><img alt="Right Click Icon"src=https://i.ibb.co/YR3vKZt/icons8-right-click-96.png style=vertical-align:middle;width:50px;height:50px></div><div><div style=font-weight:700 data-translate="Rotate the map">Rotate the map</div><div data-translate="Right mouse button click + drag">Right mouse button click + drag</div></div></div><br></div><button class=fullscreen-button onclick=fullscreen()><span class=material-symbols-outlined>fullscreen</span> <span class=tooltip-right data-translate="Toggle fullscreen">Toggle fullscreen</span></button> <button class=stats-button onclick=toggleSlideMenuStats()><span class=material-icons-outlined>donut_large</span> <span class=tooltip-left data-translate="Show Dashboard">Show Dashboard</span></button><div class=slideMenuStats id=slideMenuStats><div class=slideMenuStats-content><span class="material-icons-outlined slideMenuStats-close"onclick=toggleSlideMenuStats()>close</span><h2 class=dashboard-title data-translate=Dashboard>Dashboard</h2><div style=display:flex;align-items:center;justify-content:center;gap:30px;width:100%><div style=display:flex;align-items:center;flex-direction:column><div style=display:flex;align-items:center><img alt="Farm Icon"src=https://i.ibb.co/0QhPSvr/icons8-land-plot-64.png style=width:50px;height:50px><div class=farm-count id=totalfarmCount style=margin-top:-10px;margin-left:10px></div></div><div class=section-title data-translate=farms style=text-align:center;margin-top:-10px>farms</div></div><div style=display:flex;align-items:center;flex-direction:column><div style=display:flex;align-items:center><img alt="Farm Icon"src=https://i.ibb.co/qkqGjtM/icons8-rhomboid-shape-100.png style=width:40px;height:40px><div class=totalfarmarea-sum id=totalFarmAreaSum style=margin-top:-10px;margin-left:10px></div><div class=section-title style=margin-top:10px;margin-left:5px>ha.</div></div><div class=section-title data-translate="Land Area (Total)"style=text-align:center;margin-top:-10px>Land Area (Total)</div></div></div><div class=divider></div><div style=display:flex;align-items:center;flex-direction:column><div style=display:flex;align-items:center><img alt="RFID Sensor Icon"src=https://i.ibb.co/1dggvZL/icons8-rfid-sensor-96.png style=width:50px;height:50px><div class=device-count id=totalDevicesCount style=margin-top:-10px;margin-left:10px></div></div><div class=section-title data-translate="enfarm devices deployed"style=text-align:center;margin-top:-10px>enfarm devices deployed</div></div><div class=divider></div><br><div style=display:flex;align-items:center><img alt="Farm Icon"src=https://i.ibb.co/Q9mfK1v/icons8-alert-96.png style=width:60px;height:60px;margin-right:8px;margin-top:-30px;color:#545454><div class=needattention-sum id=needAttentionSum style=padding-bottom:5px></div><div class=section-title>  /</div><div class=section-title id=totalDevicesCountFraction></div><div class=section-title data-translate=farm(s)>  farm(s)</div></div><div class=section-title data-translate="farms needing attention">farms needing attention</div><div class=divider></div><br><div class=section-title data-translate="Productivity (Total)"style=text-align:center>Productivity (Total)</div><br><br><div style=display:flex;justify-content:space-between;align-items:center;margin-bottom:10px><div style=display:flex;align-items:center><span class=material-symbols-outlined style=font-size:40px;color:#545454;margin-right:0;margin-top:-30px>weight</span><div class=currentproductivity-sum id=currentProductivitySum></div><div class=section-title>  t</div></div><div style=width:20px></div><div style=display:flex;align-items:center><span class=material-icons-outlined style=font-size:20px;color:#545454;margin-right:0;margin-top:-30px>north_east </span><span class=material-symbols-outlined style=font-size:40px;color:#545454;margin-left:-5px;margin-top:-30px>weight</span><div class=expectedproductivity-sum id=expectedProductivitySum style=padding-bottom:5px></div><div class=section-title>  t</div></div></div><div style=display:flex;justify-content:space-between><div class=section-title data-translate="Current Productivity"style=text-align:left>Current Prod.</div><div style=width:50px></div><div class=section-title data-translate="Expected Productivity"style=text-align:left>Expected Prod.</div></div><div class=divider></div><br><div class=farm-grid><div class=farm-pair><div class="farm-icon coffeefarms-icon"></div><div class=coffeefarms-count id=totalcoffeefarmsCount></div><div class=section-title data-translate="Coffee cultivation">Coffee cultivation</div></div><div class=farm-pair><div class="farm-icon durianfarms-icon"></div><div class=durianfarms-count id=totaldurianfarmsCount></div><div class=section-title data-translate="Durian cultivation">Durian cultivation</div></div><div class=farm-pair><div class="farm-icon pepperfarms-icon"></div><div class=pepperfarms-count id=totalpepperfarmsCount></div><div class=section-title data-translate="Pepper cultivation">Pepper cultivation</div></div><div class=farm-pair><div class="farm-icon teafarms-icon"></div><div class=teafarms-count id=totalteafarmsCount></div><div class=section-title data-translate="Tea cultivation">Tea cultivation</div></div></div><div class=divider></div><div class=section-title data-translate="cultivate distribution">cultivate distribution</div><p></p><canvas id=treeTypeChart></canvas></div></div><div class=popup-historicalsoildata id=popup-historicalsoildata style=display:none><h4 class=title style=display:inline-flex;align-items:center><span class=material-symbols-outlined style=margin-top:3px>speed</span>  <span data-translate="Current Measure">Current Measure</span></h4><div class=gauge-wrapper data-farm-type=both><div class=canvas-container data-farm-type=durian><canvas id=ntsGauge data-farm-type=durian></canvas><canvas id=p205Gauge data-farm-type=durian></canvas><canvas id=k2oGauge data-farm-type=durian></canvas></div><div class=canvas-container-2><canvas id=npkGauge data-farm-type=coffee></canvas><canvas id=moistGauge data-farm-type=both></canvas><canvas id=pHGauge data-farm-type=both></canvas><canvas id=tempGauge data-farm-type=both></canvas></div></div><br><div class=header><h4 class=title><span class=material-symbols-outlined style=margin-top:3px>history</span>  <span data-translate="Historical Soil Data">Historical Soil Data</span></h4><button class=close-btn style=color:#555>×</button></div><div class=timeTrend-buttons><button data-translate=1D>1D</button> <button data-translate=1W>1W</button> <button data-translate=2W>2W</button> <button data-translate=1M>1M</button> <button data-translate=3M>3M</button> <button data-translate=6M>6M</button> <button data-translate=1Y>1Y</button> <button data-translate=3Y>3Y</button> <button data-translate=5Y>5Y</button></div><div class=divider></div><div class=durian-charts data-farm-type=durian><div class=headerNTS><h5 class=title><span class=material-icons-outlined style=margin-top:3px>bubble_chart</span>   <span data-translate="Latest NTS">Latest NTS</span></h5><div id=nts-recommendation-container><span class=tooltip id=ntsrecommendation-tooltip><span class=material-icons-outlined style=vertical-align:middle>lightbulb</span>  <span data-translate=Recommendations>Recommendations</span><p></span></div></div><br><canvas id=ntsChart data-farm-type=durian></canvas><div class=headerP205><h5 class=title><span class=material-symbols-outlined style=margin-top:3px>bubble_chart</span>   <span data-translate="Latest P205">Latest P205</span></h5><div id=p205-recommendation-container><span class=tooltip id=p205recommendation-tooltip><span class=material-icons-outlined style=vertical-align:middle>lightbulb</span>  <span data-translate=Recommendations>Recommendations</span><p></span></div></div><br><canvas id=p205Chart data-farm-type=durian></canvas><div class=headerk2o><h5 class=title><span class=material-symbols-outlined style=margin-top:3px>bubble_chart</span>   <span data-translate="Latest k2o">Latest k2o</span></h5><div id=k2o-recommendation-container><span class=tooltip id=k2orecommendation-tooltip><span class=material-icons-outlined style=vertical-align:middle>lightbulb</span>  <span data-translate=Recommendations>Recommendations</span><p></span></div></div><br><canvas id=k2oChart data-farm-type=durian></canvas></div><div class=headerNPK><h5 class=title><span class=material-icons-outlined style=margin-top:3px>bubble_chart</span>  <span data-translate="Latest NPK">Latest NPK</span></h5><div id=npk-recommendation-container><span class=tooltip id=npkreccomendation-tooltip><span class=material-icons-outlined style=vertical-align:middle>lightbulb</span>  <span data-translate=Recommendations>Recommendations</span><p></span></div></div><br><canvas id=npkChart data-farm-type=coffee></canvas><div class=headerMoist><h5 class=title><span class=material-symbols-outlined style=margin-top:3px>humidity_mid</span>  <span data-translate="Latest Moisture">Latest Moisture</span></h5><div id=moisture-recommendation-container><span class=tooltip id=moisturerecommendation-tooltip><span class=material-icons-outlined style=vertical-align:middle>lightbulb</span>  <span data-translate=Recommendations>Recommendations:</span><p></span></div></div><br><canvas id=moistChart data-farm-type=both></canvas><div class=headerpH><h5 class=title><span class=material-symbols-outlined style=margin-top:3px>water_ph</span>  <span data-translate="Latest pH">Latest pH</span></h5><div id=ph-recommendation-container><span class=tooltip id=phrecommendation-tooltip><span class=material-icons-outlined style=vertical-align:middle>lightbulb</span>  <span data-translate=Recommendations>Recommendations:</span><p></span></div></div><br><canvas id=phChart data-farm-type=both></canvas><div class=headerTemp><h5 class=title><span class=material-symbols-outlined style=margin-top:3px>device_thermostat</span>  <span data-translate="Latest Temp">Latest Temp</span></h5><div id=temp-recommendation-container><span class=tooltip id=temprecommendation-tooltip><span class=material-icons-outlined style=vertical-align:middle>lightbulb</span>  <span data-translate=Recommendations>Recommendations:</span><p></span></div></div><br><canvas id=tempChart data-farm-type=both></canvas><br><br></div><script src=authenticateduser.js></script><script src=switchlang.js></script><script src=mapbox3Dterrain.js></script><script src=mapbox3Dsearch.js></script><script src=mapboxpopup.js></script><script src=infobox.js></script><script src=mapboxrotation.js></script><script src=mapboxraineffect.js></script><script src=mapboxnightmode.js></script><script src=mapboxsunsetmode.js></script><script src=mapboxnortharrow.js></script><script src=mapboxsimulationspanel.js></script><script src=gaugeslinecharthistoricaldata.js></script><script src=treetypecount.js></script><script src=sumfarmarea.js></script><script src=mapboxfarmlist.js></script><script src=fullscreen.js></script><script>// Toggle slide menu stats
        function toggleSlideMenuStats() {
            const slideMenuStats = document.getElementById('slideMenuStats');
            slideMenuStats.classList.toggle('active');
        }

        //navigate to 2D leaflet map
        function switch2Dmap() {
            window.location.href = 'index.html';
        }

        window.currentLang = 'vi';
        function getRainViewerText(key) {
            return translations[currentLang][key] || translations['vi'][key];
        }



        document.addEventListener('DOMContentLoaded', function () {
            const instructionsButton = document.getElementById('instructionsButton');
            const instructionsWindow = document.getElementById('instructions-window');
            const closeInstructionsButton = document.getElementById('closeInstructions');

            // Function to toggle the instructions window
            function toggleInstructions() {
                if (instructionsWindow.style.display === 'none') {
                    instructionsWindow.style.display = 'block';
                } else {
                    instructionsWindow.style.display = 'none';
                }
            }

            // Event listener for the instructions button
            instructionsButton.addEventListener('click', toggleInstructions);

            // Event listener for the close button
            closeInstructionsButton.addEventListener('click', function () {
                instructionsWindow.style.display = 'none';
            });
        });




                function loadPage() {
            // Translate initial content to Vietnamese
            translatePageTo(currentLang);
        }

        function toggleLanguage() {
            currentLang = currentLang === 'en' ? 'vi' : 'en';
            translatePageTo(currentLang);
        }

        function translatePageTo(lang) {
            const elements = document.querySelectorAll('[data-translate]');
            const langSwitchButton = document.getElementById('lang-switch');

            langSwitchButton.innerText = lang === 'en' ? 'EN ' : 'VN ';
            langSwitchButton.innerHTML += lang === 'en' ? '<i class="fa-solid fa-earth-americas"></i>' : '<i class="fa-solid fa-earth-asia"></i>';

            elements.forEach(element => {
                const key = element.getAttribute('data-translate');
                element.innerText = translations[lang][key] || element.innerText;
            });
        }</script>