<!DOCTYPE html><html lang=en><head><meta charset=utf-8><title>enfarm 3D viewer</title><meta name=viewport content="initial-scale=1,maximum-scale=1,user-scalable=no"><link rel=icon href=images/enfarm-favicon.png type=image/png><link href=https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css rel=stylesheet><script src=https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js></script><link href="https://fonts.googleapis.com/css2?family=Be+Vietnam:wght@400;500;600;700&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel=stylesheet><script src=https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js></script><script src=https://cdn.jsdelivr.net/npm/chart.js></script><script src=https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js integrity="sha256-8BDDxChCyYOB80/6VhOpmr7qI5EIDyDPzxsWePPFVfo=" crossorigin=anonymous></script><script src=https://kit.fontawesome.com/0eb73cfc5c.js crossorigin=anonymous></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css><link rel=stylesheet href=https://cdn-uicons.flaticon.com/uicons-thin-straight/css/uicons-thin-straight.css><link rel=stylesheet href=https://cdn-uicons.flaticon.com/2.4.2/uicons-thin-rounded/css/uicons-thin-rounded.css><link rel=stylesheet href=https://cdn-uicons.flaticon.com/2.4.2/uicons-regular-straight/css/uicons-regular-straight.css><link rel=stylesheet href=https://cdn-uicons.flaticon.com/2.4.2/uicons-regular-rounded/css/uicons-regular-rounded.css><link rel=stylesheet href=https://cdn-uicons.flaticon.com/2.4.2/uicons-bold-straight/css/uicons-bold-straight.css><link rel=stylesheet href=./mapbox3Dterrain.css><link rel=stylesheet href=./mapboxfarmlist.css><style>
        /*North Arrow*/
        .north-arrow {
            position: absolute;
            top: 100px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 99999;
        }

        .north-arrow-icon {
            font-size: 48px;
            text-shadow: 0 0 5px rgba(109, 109, 109, 0.9);
            color: rgb(56, 56, 56);
        }

        .north-text {
            position: absolute;
            top: 40px;
            left: 15px;
            font-size: 20px;
            font-weight: bolder;
            color: rgb(255, 0, 0);
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.9);
        }
    </style></head><body><div id=map><canvas id=rainCanvas></canvas><div id=inset-map></div></div><a href=https://enfarm.com/ target=_blank><img src=images/enfarm_logo.png class=company-logo3D alt="enfarm Logo"></a><div class=search-container><input type=text class=search-input placeholder=Search... oninput=searchFeatures(this.value) id=searchInput><button class=clear-button onclick=clearSearch() style="display: none;"><span class=material-icons-outlined>close</span></button></div><div id=popup-farmlist class=popup-farmlist><button class=close-farmlist-btn onclick=hideFarmList() style="color: #555;">&times;</button><div class=farmlist-header><div style="display: flex; align-items: center;"><span class=material-symbols-outlined style="margin-right: 4px;">psychiatry</span><h3 style="margin: 0;" data-translate="Managed Farms">Managed Farms</h3></div><div class=sort-dropdown><button id=sort-button class=sortButton><span data-translate=Sort>Sort</span>&nbsp; <i class="fi fi-bs-angle-small-down"></i></button><div class=dropdown-content><a href=# onclick="sortFarmList('status')" data-translate=Status>Status</a><a href=# onclick="sortFarmList('size')" data-translate="Farm size">Farm size</a><a href=# onclick="sortFarmList('lastUpdated')" data-translate="Last updated">Last updated</a><a href=# onclick="sortFarmList('name')" data-translate=Name>Name</a><a href=# onclick="sortFarmList('produce')" data-translate=Produce>Produce</a></div></div></div><div id=farm-list-container class=farm-list-container><div class=fetching-data data-translate="Fetching farm data...">Fetching farm data...</div><div class=sorting-message></div></div></div><button id=lang-switch class=lang-switch onclick=toggleLanguage() aria-label="Toggle Language" style="margin-right: 5px;"> VN <i class="fa-solid fa-earth-asia"></i><span class=tooltip-right data-translate="Switch Language">Switch Language</span></button><button class=switch2Dmap-button onclick=switch2Dmap()><span class=material-symbols-outlined>2d</span><span class=tooltip-right data-translate="Switch to 2D Map View">Switch to 2D Map View</span></button><button class=mapbox3Dterrain-button onclick=switchBasemap()><span class=material-icons-outlined>landscape</span><span class=tooltip-right data-translate="Switch Basemap">Switch Basemap</span></button><button class=farmlist-button onclick=toggleFarmList()><span class=material-symbols-outlined>list</span><span class=tooltip-right data-translate="See lists of managed farms">See lists of managed farms</span></button><button class=simulationToggle-button onclick=toggleSimulationPanel()><span class=material-symbols-outlined>token</span><span class=tooltip-right data-translate=Simulation>Simulation</span></button><div class=simulation-buttons-container><button class=animateRotate-button onclick=toggleRotation(this)><span id=icon class=material-icons-outlined>play_circle</span></button><button class=weatherToggle-button onclick=toggleRainEffect()><span class=material-symbols-outlined>rainy</span></button><button class=nightToggle-button onclick=toggleNightEffect()><span class=material-symbols-outlined>nights_stay</span></button><button class=sunsetToggle-button onclick=toggleSunsetEffect()><span class=material-symbols-outlined>wb_twilight</span></button><div class=simulation-panel><span class="material-symbols-outlined icon">token</span><h3 class=simulate-text data-translate=Simulate>Simulate</h3><div class=bottom-animatetext><span data-translate=animate>animate</span></div><div class=bottom-raintext><span data-translate=rain>rain</span></div><div class=bottom-nighttext><span data-translate=night>night</span></div><div class=bottom-sunsettext><span data-translate=sunset>sunset</span></div></div></div><button class=info-button onclick=toggleInfo()><span class=material-icons-outlined>info</span><span class=tooltip-left data-translate="About the Application">About the Application</span></button><div class=info-box><div class=info-content><div class=info-image></div><p data-translate=About>About</p><div class=info-logo><img src=images/fd57352e4cea98b4c1fb.jpg alt="enFarm Logo" style="width: 80px; height: auto;"></div><p data-translate="Map application to track and visualize deployed enfarm devices">Map application to track and visualize deployed enfarm devices</p><button class=dismiss-button onclick=toggleInfo() data-translate=Dismiss>Dismiss</button></div></div><button class=instructions-button id=instructionsButton><span class=material-icons-outlined>mouse</span><span class=tooltip-left data-translate="Show Instructions">Show Instructions</span></button><div id=instructions-window class=instructions-window><button id=closeInstructions class=close-button><span class=material-icons-outlined>close</span></button><div style="display: flex; align-items: center; margin-bottom: 20px; margin-top: 10px;"><span class=material-icons-outlined style="margin-right: 5px;">mouse</span><h3 style="font-weight: bold; margin: 0;" data-translate="Navigating the 3D Map">Navigating the 3D Map</h3></div><div style="display: flex; align-items: center;"><div><img src=images/icons8-left-click-96.png alt="Left Mouse Click Icon" style="vertical-align: middle; width: 50px; height: 50px;"></div><div style="margin-left: 10px;"><div style="font-weight: bold;" data-translate="Show farm information">Show farm information</div><div data-translate="Left mouse button click on a farm point">Left mouse button click on a farm point </div></div></div><div style="display: flex; align-items: center; margin-top: 10px;"><div><img src=images/icons8-left-click-96.png alt="Left Mouse Click Icon" style="vertical-align: middle; width: 50px; height: 50px;"></div><div style="margin-left: 10px;"><div style="font-weight: bold;" data-translate="Pan the map">Pan the map</div><div data-translate="Left mouse button click + drag">Left mouse button click + drag</div></div></div><div style="display: flex; align-items: center; margin-top: 10px;"><div style="margin-left: 2px;"><img src=images/icons8-mouse-scrolling-96.png alt="Mouse Scrolling Icon" style="vertical-align: middle; width: 50px; height: 50px;"></div><div style="margin-left: 10px;"><div style="font-weight: bold;" data-translate="Zoom the map view">Zoom the map view</div><div data-translate="Use the mouse scroll wheel">Use the mouse scroll wheel</div></div></div><div style="display: flex; align-items: center; margin-top: 10px;"><div style="margin-left: 6px; margin-right: 10px;"><img src=https://i.ibb.co/YR3vKZt/icons8-right-click-96.png alt="Right Click Icon" style="vertical-align: middle; width: 50px; height: 50px;"></div><div><div style="font-weight: bold;" data-translate="Rotate the map">Rotate the map</div><div data-translate="Right mouse button click + drag">Right mouse button click + drag</div></div></div><br></div><button class=fullscreen-button onclick=fullscreen()><span class=material-symbols-outlined>fullscreen</span><span class=tooltip-right data-translate="Toggle fullscreen">Toggle fullscreen</span></button><button class=stats-button onclick=toggleSlideMenuStats()><span class=material-icons-outlined>donut_large</span><span class=tooltip-left data-translate="Show Dashboard">Show Dashboard</span></button><div id=slideMenuStats class=slideMenuStats><div class=slideMenuStats-content><span class="material-icons-outlined slideMenuStats-close" onclick=toggleSlideMenuStats()>close</span><h2 class=dashboard-title data-translate=Dashboard>Dashboard</h2><div style="display: flex; align-items: center; justify-content: center; gap: 30px; width: 100%;"><div style="display: flex; align-items: center; flex-direction: column;"><div style="display: flex; align-items: center;"><img src=images/icons8-land-plot-64.png alt="Farm Icon" style="width: 50px; height: 50px;"><div class=farm-count id=totalfarmCount style="margin-top: -10px; margin-left: 10px;"></div></div><div class=section-title style="text-align: center; margin-top: -10px;" data-translate=farms> farms</div></div><div style="display: flex; align-items: center; flex-direction: column;"><div style="display: flex; align-items: center;"><img src=https://i.ibb.co/qkqGjtM/icons8-rhomboid-shape-100.png alt="Farm Icon" style="width: 40px; height: 40px;"><div class=totalfarmarea-sum id=totalFarmAreaSum style="margin-top: -10px; margin-left: 10px;"></div><div class=section-title style="margin-top: 10px; margin-left: 5px;">ha.</div></div><div class=section-title style="text-align: center; margin-top: -10px;" data-translate="Land Area (Total)">Land Area (Total)</div></div></div><div class=divider></div> <div style="display: flex; align-items: center; flex-direction: column;"><div style="display: flex; align-items: center;"><img src=images/icons8-rfid-sensor-96.png alt="RFID Sensor Icon" style="width: 50px; height: 50px;"><div class=device-count id=totalDevicesCount style="margin-top: -10px; margin-left: 10px;"></div></div><div class=section-title style="text-align: center; margin-top: -10px;" data-translate="enfarm devices deployed">enfarm devices deployed</div></div><div class=divider></div> <br><div style="display: flex; align-items: center;"><img src=images/icons8-alert-96.png alt="Farm Icon" style="width: 60px; height: 60px; margin-right: 8px; margin-top: -30px; color: #545454;"><div class=needattention-sum id=needAttentionSum style="padding-bottom: 5px;"></div><div class=section-title>&nbsp;&nbsp;/</div><div class=section-title id=totalDevicesCountFraction></div><div class=section-title data-translate=farm(s)>&nbsp;&nbsp;farm(s)</div></div><div class=section-title data-translate="farms needing attention">farms needing attention</div><div class=divider></div> <br><div class=section-title style="text-align: center;" data-translate="Productivity (Total)">Productivity (Total)</div><br><br><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;"><div style="display: flex; align-items: center;"><span class=material-symbols-outlined style="font-size: 40px; color: #545454; margin-right: 0px; margin-top: -30px;"> weight </span><div class=currentproductivity-sum id=currentProductivitySum style="padding-bottom: -10px;"></div><div class=section-title>&nbsp;&nbsp;t</div></div><div style="width: 20px;"></div><div style="display: flex; align-items: center;"><span class=material-icons-outlined style="font-size: 20px; color: #545454; margin-right: 0px; margin-top: -30px;"> north_east </span><span class=material-symbols-outlined style="font-size: 40px; color: #545454; margin-left: -5px; margin-top: -30px;"> weight </span><div class=expectedproductivity-sum id=expectedProductivitySum style="padding-bottom: 5px;"></div><div class=section-title>&nbsp;&nbsp;t</div></div></div><div style="display: flex; justify-content: space-between;"><div class=section-title style="text-align: left;" data-translate="Current Productivity">Current Prod. </div><div style="width: 50px;"></div><div class=section-title style="text-align: left;" data-translate="Expected Productivity">Expected Prod. </div></div><div class=divider></div> <br><div class=farm-grid><div class=farm-pair><div class="farm-icon coffeefarms-icon"></div><div class=coffeefarms-count id=totalcoffeefarmsCount></div><div class=section-title data-translate="Coffee cultivation">Coffee cultivation</div></div><div class=farm-pair><div class="farm-icon durianfarms-icon"></div><div class=durianfarms-count id=totaldurianfarmsCount></div><div class=section-title data-translate="Durian cultivation">Durian cultivation</div></div><div class=farm-pair><div class="farm-icon pepperfarms-icon"></div><div class=pepperfarms-count id=totalpepperfarmsCount></div><div class=section-title data-translate="Pepper cultivation">Pepper cultivation</div></div><div class=farm-pair><div class="farm-icon teafarms-icon"></div><div class=teafarms-count id=totalteafarmsCount></div><div class=section-title data-translate="Tea cultivation">Tea cultivation</div></div></div><div class=divider></div><div class=section-title data-translate="cultivate distribution">cultivate distribution</div><p></p><canvas id=treeTypeChart></canvas></div></div><div id=popup-historicalsoildata class=popup-historicalsoildata style="display: none;"><button class=close-btn style="color: #555;">&times;</button><h4 class=title style="display: flex; align-items: center; margin-bottom: 2px;"><span class=material-symbols-outlined style="margin-top: 3px;">psychiatry</span><span id=farmName style="margin-right: 10px; margin-left: 5px;">Farm Name</span><button id=recenterBtn class=recenter-btn style="background: none; border: none; padding: 0; cursor: pointer; font-size: 12px; color: #555;"><span class=material-symbols-outlined style="font-size: 18px;">zoom_in</span></button></h4><h6 class=title style="display: flex; align-items: center; margin-top: 0; margin-bottom: 2px; font-weight: normal;"><span class=material-symbols-outlined style="margin-top: 3px; font-size: 12px; margin-left: 5px;">location_on</span><span id=address style="margin-left: 5px;">Address</span></h6><div class=popup-content><h4 class=title style="display: inline-flex; align-items: center;"><span class=material-symbols-outlined style="margin-top: 3px;">speed</span>&nbsp;&nbsp;<span data-translate="Current Measure">Current Measure</span></h4><div class=gauge-wrapper data-farm-type=both><div class=canvas-container data-farm-type=durian><canvas id=ntsGauge data-farm-type=durian></canvas><canvas id=p205Gauge data-farm-type=durian></canvas><canvas id=k2oGauge data-farm-type=durian></canvas></div><div class=canvas-container-2><canvas id=npkGauge data-farm-type=coffee></canvas><canvas id=moistGauge data-farm-type=both></canvas><canvas id=pHGauge data-farm-type=both></canvas><canvas id=tempGauge data-farm-type=both></canvas></div></div><div class=zone-boxes><div class=zone-item><div class=zone-box style="background-color: #18A558;"></div><p data-translate="Safe zone">Safe Zone</p></div><div class=zone-item><div class=zone-box style="background-color: #BA0F30;"></div><p data-translate="Unsafe zone">Unsafe Zone</p></div></div><br><div class=timeTrend-container><div class=header><h4 class=title><span class=material-symbols-outlined style="margin-top: 3px;">history</span>&nbsp;&nbsp; <span data-translate="Historical Soil Data">Historical Soil Data</span></h4></div><div class=timeTrend-buttons><button data-translate=1D>1D</button><button data-translate=1W>1W</button><button data-translate=2W>2W</button><button data-translate=1M>1M</button><button data-translate=3M>3M</button><button data-translate=6M>6M</button><button data-translate=1Y>1Y</button><button data-translate=3Y>3Y</button><button data-translate=5Y>5Y</button></div></div><div class=divider></div> <div class=durian-charts data-farm-type=durian><div class=headerNTS><h5 class=title><span class=material-icons-outlined style="margin-top: 3px;">bubble_chart</span>&nbsp;&nbsp; <span data-translate="Latest NTS">Latest NTS</span></h5><div id=nts-recommendation-container><span id=ntsrecommendation-tooltip class=tooltip><span class=material-icons-outlined style="vertical-align: middle;">lightbulb</span>&nbsp; <span data-translate=Recommendations>Recommendations</span><p></p></span></div></div><br><div id=ntsChartContainer data-farm-type=durian style="position: relative;"><canvas id=ntsChart></canvas></div><br><div class=headerP205><h5 class=title><span class=material-symbols-outlined style="margin-top: 3px;">bubble_chart</span>&nbsp;&nbsp; <span data-translate="Latest P205">Latest P205</span></h5><div id=p205-recommendation-container><span id=p205recommendation-tooltip class=tooltip><span class=material-icons-outlined style="vertical-align: middle;">lightbulb</span>&nbsp; <span data-translate=Recommendations>Recommendations</span><p></p></span></div></div><br><div id=p205ChartContainer data-farm-type=durian style="position: relative;"><canvas id=p205Chart></canvas></div><br><div class=headerk2o><h5 class=title><span class=material-symbols-outlined style="margin-top: 3px;">bubble_chart</span>&nbsp;&nbsp; <span data-translate="Latest k2o">Latest k2o</span></h5><div id=k2o-recommendation-container><span id=k2orecommendation-tooltip class=tooltip><span class=material-icons-outlined style="vertical-align: middle;">lightbulb</span>&nbsp; <span data-translate=Recommendations>Recommendations</span><p></p></span></div></div><br><div id=k2oChartContainer data-farm-type=durian style="position: relative;"><canvas id=k2oChart></canvas></div></div><div class=headerNPK data-farm-type=coffee><h5 class=title><span class=material-icons-outlined style="margin-top: 3px;">bubble_chart</span>&nbsp;&nbsp; <span data-translate="Latest NPK">Latest NPK</span></h5><div id=npk-recommendation-container><span id=npkreccomendation-tooltip class=tooltip><span class=material-icons-outlined style="vertical-align: middle;">lightbulb</span>&nbsp; <span data-translate=Recommendations>Recommendations</span><p></p></span></div></div><br><div id=npkChartContainer data-farm-type=coffee style="position: relative;"><canvas id=npkChart></canvas></div><div class=headerMoist data-farm-type=both><h5 class=title><span class=material-symbols-outlined style="margin-top: 3px;">humidity_mid</span>&nbsp;&nbsp; <span data-translate="Latest Moisture">Latest Moisture</span></h5><div id=moisture-recommendation-container><span id=moisturerecommendation-tooltip class=tooltip><span class=material-icons-outlined style="vertical-align: middle;">lightbulb</span>&nbsp; <span data-translate=Recommendations>Recommendations:</span><p></p></span></div></div><br><div id=moistureChartContainer data-farm-type=both style="position: relative;"><canvas id=moistChart></canvas></div><div class=headerpH data-farm-type=both><h5 class=title><span class=material-symbols-outlined style="margin-top: 3px;">water_ph</span>&nbsp;&nbsp; <span data-translate="Latest pH">Latest pH</span></h5><div id=ph-recommendation-container><span id=phrecommendation-tooltip class=tooltip><span class=material-icons-outlined style="vertical-align: middle;">lightbulb</span>&nbsp; <span data-translate=Recommendations>Recommendations:</span><p></p></span></div></div><br><div id=pHChartContainer data-farm-type=both style="position: relative;"><canvas id=phChart></canvas></div><div class=headerTemp data-farm-type=both><h5 class=title><span class=material-symbols-outlined style="margin-top: 3px;">device_thermostat</span>&nbsp;&nbsp; <span data-translate="Latest Temp">Latest Temp</span></h5><div id=temp-recommendation-container><span id=temprecommendation-tooltip class=tooltip><span class=material-icons-outlined style="vertical-align: middle;">lightbulb</span>&nbsp; <span data-translate=Recommendations>Recommendations:</span><p></p></span></div></div><br><div id=tempChartContainer data-farm-type=both style="position: relative;"><canvas id=tempChart></canvas></div></div><br><script src=authenticateduser.js></script><script src=switchlang.js></script><script src=mapbox3Dterrain.js></script><script src=mapbox3Dsearch.js></script><script src=mapboxpopup.js></script><script src=infobox.js></script><script src=mapboxrotation.js></script><script src=mapboxraineffect.js></script><script src=mapboxnightmode.js></script><script src=mapboxsunsetmode.js></script><script src=mapboxnortharrow.js></script><script src=mapboxsimulationspanel.js></script><script src=gaugeslinecharthistoricaldata.js></script><script src=reccomendations.js></script><script src=treetypecount.js></script><script src=sumfarmarea.js></script><script src=mapboxfarmlist.js></script><script src=fullscreen.js></script><script>

            // Toggle slide menu stats
            function toggleSlideMenuStats() {
                const slideMenuStats = document.getElementById('slideMenuStats');
                slideMenuStats.classList.toggle('active');
            }

            //navigate to 2D leaflet map
            function switch2Dmap() {
                window.location.href = 'index.html';
            }

            window.currentLang = 'vi';
            function getRainViewerText(key) {
                return translations[currentLang][key] || translations['vi'][key];
            }



            document.addEventListener('DOMContentLoaded', function () {
                const instructionsButton = document.getElementById('instructionsButton');
                const instructionsWindow = document.getElementById('instructions-window');
                const closeInstructionsButton = document.getElementById('closeInstructions');

                // Function to toggle the instructions window
                function toggleInstructions() {
                    if (instructionsWindow.style.display === 'none') {
                        instructionsWindow.style.display = 'block';
                    } else {
                        instructionsWindow.style.display = 'none';
                    }
                }

                // Event listener for the instructions button
                instructionsButton.addEventListener('click', toggleInstructions);

                // Event listener for the close button
                closeInstructionsButton.addEventListener('click', function () {
                    instructionsWindow.style.display = 'none';
                });
            });



            /*
                    function loadPage() {
                        // Translate initial content to Vietnamese
                        translatePageTo(currentLang);
                    }
            
                    function toggleLanguage() {
                        currentLang = currentLang === 'en' ? 'vi' : 'en';
                        translatePageTo(currentLang);
                    }
            
                    function translatePageTo(lang) {
                        const elements = document.querySelectorAll('[data-translate]');
                        const langSwitchButton = document.getElementById('lang-switch');
            
                        langSwitchButton.innerText = lang === 'en' ? 'EN ' : 'VN ';
                        langSwitchButton.innerHTML += lang === 'en' ? '<i class="fa-solid fa-earth-americas"></i>' : '<i class="fa-solid fa-earth-asia"></i>';
            
                        elements.forEach(element => {
                            const key = element.getAttribute('data-translate');
                            element.innerText = translations[lang][key] || element.innerText;
                        });
                    }*/
        </script></body></html>