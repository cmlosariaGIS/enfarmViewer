async function searchFeatures(query){const clearButton=document.querySelector('.clear-button');if(query.trim()!==''){clearButton.style.display='block'}else{clearButton.style.display='none'}
try{const response=await fetch('https://api-ma.enfarm.com/api/v1/ma/get-install-locations');const data=await response.json();const filteredLocations=data.content.filter(location=>{return location.farmname.toLowerCase().includes(query.toLowerCase())});markers.forEach(marker=>marker.remove());filteredLocations.forEach(location=>{const el=document.createElement('div');el.className='marker';const marker=new mapboxgl.Marker(el).setLngLat([location.long,location.lat]).setPopup(new mapboxgl.Popup().setHTML(`<b>Farm name:</b> ${location.farmname}<br><b>Region name:</b> ${location.region_name}`)).addTo(map);markers.push(marker)});if(filteredLocations.length>0){map.flyTo({center:[filteredLocations[0].long,filteredLocations[0].lat],zoom:15})}}catch(error){console.error('Error fetching or processing data:',error)}}
function clearSearch(){const searchInput=document.getElementById('searchInput');const clearButton=document.querySelector('.clear-button');searchInput.value='';clearButton.style.display='none';markers.forEach(marker=>marker.remove());markers=[]}
