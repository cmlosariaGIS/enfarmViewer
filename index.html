<!doctypehtml><html lang=en><meta charset=UTF-8><meta content="width=device-width,initial-scale=1"name=viewport><title>enfarm Enterprise Platform</title><link href=https://i.ibb.co/tQDxF41/enfarm-favicon.png rel=icon type=image/png><link href=./leaflet.css rel=stylesheet><link href=./style.css rel=stylesheet><link href=./userlocation.css rel=stylesheet><link href=./search.css rel=stylesheet><link href=./rainviewer.css rel=stylesheet><link href=./farmlist.css rel=stylesheet><link href=./filters.css rel=stylesheet><script src=https://unpkg.com/leaflet/dist/leaflet.js></script><script src=https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js></script><link href=https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css rel=stylesheet><link href=https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Be+Vietnam:wght@400;500;600;700&display=swap"rel=stylesheet><link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.19/topojson.min.js></script><link href=https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css rel=stylesheet><script src=https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js></script><script src=https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js></script><script src=https://cdn.jsdelivr.net/npm/chart.js></script><script src=https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js crossorigin=anonymous integrity="sha256-8BDDxChCyYOB80/6VhOpmr7qI5EIDyDPzxsWePPFVfo="></script><script src=https://kit.fontawesome.com/0eb73cfc5c.js crossorigin=anonymous></script><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.7.14/lottie.min.js></script><link href=https://cdn-uicons.flaticon.com/uicons-thin-straight/css/uicons-thin-straight.css rel=stylesheet><link href=https://cdn-uicons.flaticon.com/2.4.2/uicons-thin-rounded/css/uicons-thin-rounded.css rel=stylesheet><style>.mapbox3Dterrain-button{position:absolute;top:250px;right:22px;width:40px;height:40px;border-radius:50%;border:none;background-color:#fff;color:#363636;font-size:20px;cursor:pointer;display:flex;justify-content:center;align-items:center;z-index:999;box-shadow:0 2px 4px rgba(0,0,0,.1)}.mapbox3Dterrain-button:hover{background-color:#c9c9c9}.mapbox3Dterrain-button span{line-height:1}.custom-marker{position:relative}.marker-icon{width:30px;height:30px}</style><div id=map><div class=floating-pill>All Farms</div><button class=needs-attention><div style=width:24px;height:24px id=lottie-container></div><span class=attention-text>Alert</span> <span class=tooltip-bottom>Show farms needing attention</span></button> <button class=durianTrees-filter><img alt="Durian Fruit Icon"src=https://i.ibb.co/nnrMSMd/durian-removebg-preview.png class=durian-icon> <span class=durian-text>Durian</span> <span class=tooltip-bottom>Show Durian farms</span></button> <button class=coffeeTrees-filter><img alt="Coffee Beans Icon"src=https://i.ibb.co/FnNySKq/bean-removebg-preview.png class=coffee-icon> <span class=coffee-text>Coffee</span> <span class=tooltip-bottom>Show Coffee farms</span></button> <button class=pepperFarms-filter><img alt="Pepper Icon"src=https://i.ibb.co/WxVZrLN/icons8-pepper-96.png class=pepper-icon> <span class=pepper-text>Pepper</span> <span class=tooltip-bottom>Show Pepper farms</span></button> <button class=teaFarms-filter><img alt="Tea Icon"src=https://i.ibb.co/DGScVH9/icons8-tea-leaves-64.png class=tea-icon> <span class=tea-text>Tea</span> <span class=tooltip-bottom>Show Tea farms</span></button><div id=inset-map></div></div><button class=farmlist-button onclick=toggleFarmList()><span class=material-symbols-outlined>list</span> <span class=tooltip-right>See lists of managed farms</span></button><div class=popup-farmlist id=popup-farmlist><button class=close-farmlist-btn onclick=hideFarmList() style=color:#555>×</button><div class=farmlist-header><div style=display:flex;align-items:center><span class=material-symbols-outlined style=margin-right:4px>psychiatry</span><h3 style=margin:0>Managed Farms</h3></div><div class=sort-dropdown><button class=sortButton id=sort-button>Sort By   <i class="fi fi-ts-angle-small-down"></i></button><div class=dropdown-content><a href=# onclick='sortFarmList("status")'>Status</a> <a href=# onclick='sortFarmList("size")'>Farm size</a> <a href=# onclick='sortFarmList("lastUpdated")'>Last updated</a> <a href=# onclick='sortFarmList("name")'>Name</a> <a href=# onclick='sortFarmList("produce")'>Produce</a></div></div></div><div class=farm-list-container id=farm-list-container><div class=fetching-data>Fetching farm data...</div><div class=sorting-message></div></div></div><div class=menu-bar><div class=left-section><a href=https://enfarm.com/ target=_blank><img alt="enFarm Logo"src=https://enfarm.com/fd57352e4cea98b4c1fb.jpg class=company-logo></a><div class=project-title><span>Enterprise Platform</span></div></div><div class=middle-section></div><div class=right-section><div class=search-bar><input id=searchInput placeholder="Search farms..."> <button style=color:#919191 id=searchButton><span class=material-symbols-outlined>search</span></button></div><button class=Btn onclick='location.href="logout.html"'><div class=sign><svg viewbox="0 0 512 512"><path d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"></path></svg></div><div class=text> Logout</div></button></div></div><button class=info-button onclick=toggleInfo()><span class=material-icons-outlined>info</span> <span class=tooltip-left>Show Info</span></button><div class=info-box><div class=info-content><div class=info-image></div><p>About<div class=info-logo><img alt="enFarm Logo"src=https://enfarm.com/fd57352e4cea98b4c1fb.jpg style=width:80px;height:auto></div><p>Map application to track and visualize deployed enfarm devices</p><button class=dismiss-button onclick=toggleInfo()>Dismiss</button></div></div><button class=userlocation-button onclick=locateUser()><span class=material-icons-outlined>my_location</span> <span class=tooltip-right>Locate User</span></button> <button class=fullscreen-button onclick=fullscreen()><span class=material-symbols-outlined>fullscreen</span> <span class=tooltip-right>Toggle fullscreen</span></button> <button class=mapbox3Dterrain-button onclick=call3Dmap()><span class=material-icons-outlined>landscape</span> <span class=tooltip-right>Switch to 3D Map View</span></button> <button class=stats-button onclick=toggleSlideMenuStats()><span class=material-icons-outlined>donut_large</span> <span class=tooltip-left>Show Dashboard</span></button><div class=slideMenuStats id=slideMenuStats><div class=slideMenuStats-content><span class="material-icons-outlined slideMenuStats-close"onclick=toggleSlideMenuStats()>close</span><h2 class=dashboard-title>Dashboard</h2><div style=display:flex;align-items:center;justify-content:center;gap:30px;width:100%><div style=display:flex;align-items:center;flex-direction:column><div style=display:flex;align-items:center><img alt="Farm Icon"src=https://i.ibb.co/0QhPSvr/icons8-land-plot-64.png style=width:50px;height:50px><div class=farm-count id=totalfarmCount style=margin-top:-10px;margin-left:10px></div></div><div class=section-title style=text-align:center;margin-top:-10px>farms</div></div><div style=display:flex;align-items:center;flex-direction:column><div style=display:flex;align-items:center><img alt="Farm Icon"src=https://i.ibb.co/qkqGjtM/icons8-rhomboid-shape-100.png style=width:40px;height:40px><div class=totalfarmarea-sum id=totalFarmAreaSum style=margin-top:-10px;margin-left:10px></div><div class=section-title style=margin-top:10px;margin-left:5px>ha.</div></div><div class=section-title style=text-align:center;margin-top:-10px>Land Area (Total)</div></div></div><div class=divider></div><div style=display:flex;align-items:center;flex-direction:column><div style=display:flex;align-items:center><img alt="RFID Sensor Icon"src=https://i.ibb.co/1dggvZL/icons8-rfid-sensor-96.png style=width:50px;height:50px><div class=device-count id=totalDevicesCount style=margin-top:-10px;margin-left:10px></div></div><div class=section-title style=text-align:center;margin-top:-10px>enfarm devices deployed</div></div><div class=divider></div><br><div style=display:flex;align-items:center><img alt="Farm Icon"src=https://i.ibb.co/Q9mfK1v/icons8-alert-96.png style=width:60px;height:60px;margin-right:8px;margin-top:-30px;color:#545454><div class=needattention-sum id=needAttentionSum style=padding-bottom:5px></div><div class=section-title>  /</div><div class=section-title id=totalDevicesCountFraction></div><div class=section-title>  farm(s)</div></div><div class=section-title>farms needing attention</div><div class=divider></div><br><div class=section-title style=text-align:center>Productivity (Total)</div><br><br><div style=display:flex;justify-content:space-between;align-items:center;margin-bottom:10px><div style=display:flex;align-items:center><span class=material-symbols-outlined style=font-size:40px;color:#545454;margin-right:0;margin-top:-30px>weight</span><div class=currentproductivity-sum id=currentProductivitySum></div><div class=section-title>  t</div></div><div style=width:20px></div><div style=display:flex;align-items:center><span class=material-icons-outlined style=font-size:20px;color:#545454;margin-right:0;margin-top:-30px>north_east </span><span class=material-symbols-outlined style=font-size:40px;color:#545454;margin-left:-5px;margin-top:-30px>weight</span><div class=expectedproductivity-sum id=expectedProductivitySum style=padding-bottom:5px></div><div class=section-title>  t</div></div></div><div style=display:flex;justify-content:space-between><div class=section-title style=text-align:left>Current Prod.</div><div style=width:50px></div><div class=section-title style=text-align:left>Expected Prod.</div></div><div class=divider></div><br><div class=farm-grid><div class=farm-pair><div class="farm-icon coffeefarms-icon"></div><div class=coffeefarms-count id=totalcoffeefarmsCount></div><div class=section-title>Coffee cultivation</div></div><div class=farm-pair><div class="farm-icon durianfarms-icon"></div><div class=durianfarms-count id=totaldurianfarmsCount></div><div class=section-title>Durian cultivation</div></div><div class=farm-pair><div class="farm-icon pepperfarms-icon"></div><div class=pepperfarms-count id=totalpepperfarmsCount></div><div class=section-title>Pepper cultivation</div></div><div class=farm-pair><div class="farm-icon teafarms-icon"></div><div class=teafarms-count id=totalteafarmsCount></div><div class=section-title>Tea cultivation</div></div></div><div class=divider></div><div class=section-title>cultivate distribution</div><p></p><canvas id=treeTypeChart height=300 width=200></canvas></div></div><div class=popup-historicalsoildata id=popup-historicalsoildata style=display:none><h4 class=title style=display:inline-flex;align-items:center><span class=material-symbols-outlined style=margin-top:3px>speed</span>  Current Measure</h4><div class=canvas-container><canvas id=npkGauge></canvas><canvas id=moistGauge></canvas><canvas id=pHGauge></canvas><canvas id=tempGauge></canvas><br></div><br><div class=header><h4 class=title><span class=material-symbols-outlined style=margin-top:3px>history</span>  Historical Soil Data</h4><button class=close-btn style=color:#555>×</button></div><div class=timeTrend-buttons><button>1D</button> <button>1W</button> <button>2W</button> <button>1M</button> <button>3M</button> <button>6M</button> <button>1Y</button> <button>3Y</button> <button>5Y</button></div><div class=divider></div><div class=headerNPK><h5 class=title><span class=material-icons-outlined style=margin-top:3px>bubble_chart</span>  Latest NPK</h5><div id=npk-recommendation-container><span class=tooltip id=npkreccomendation-tooltip><span class=material-icons-outlined style=vertical-align:middle>lightbulb</span>  Recommendations:<p></span></div></div><br><canvas id=npkChart></canvas><div class=headerMoist><h5 class=title><span class=material-symbols-outlined style=margin-top:3px>humidity_mid</span>  Latest Moisture</h5><div id=moisture-recommendation-container><span class=tooltip id=moisturerecommendation-tooltip><span class=material-icons-outlined style=vertical-align:middle>lightbulb</span>  Recommendations:<p></span></div></div><br><canvas id=moistChart></canvas><div class=headerpH><h5 class=title><span class=material-symbols-outlined style=margin-top:3px>water_ph</span>  Latest pH</h5><div id=ph-recommendation-container><span class=tooltip id=phrecommendation-tooltip><span class=material-icons-outlined style=vertical-align:middle>lightbulb</span>  Recommendations:<p></span></div></div><br><canvas id=phChart></canvas><br><div class=headerTemp><h5 class=title><span class=material-symbols-outlined style=margin-top:3px>device_thermostat</span>  Latest Temp</h5><div id=temp-recommendation-container><span class=tooltip id=temprecommendation-tooltip><span class=material-icons-outlined style=vertical-align:middle>lightbulb</span>  Recommendations:<p></span></div></div><br><canvas id=tempChart></canvas><br></div><script src=authenticateduser.js></script><script src=map.js></script><script src=popup.js></script><script src=linecharthistoricaldata.js></script><script src=search.js></script><script src=infobox.js></script><script src=userlocation.js></script><script src=rainviewer.js></script><script src=treetypecount.js></script><script src=sumfarmarea.js></script><script src=inset.js></script><script src=filters.js></script><script src=farmlist.js></script><script src=fullscreen.js></script><script>// Toggle slide menu stats
        function toggleSlideMenuStats() {
            const slideMenuStats = document.getElementById('slideMenuStats');
            slideMenuStats.classList.toggle('active');
        }

        // Rain viewer Panel
        var rainviewer = L.control.rainviewer({
            position: 'bottomleft',
            nextButtonText: '›',
            playStopButtonText: 'Start/Stop',
            prevButtonText: '‹',
            positionSliderLabelText: "🕐 Adjust time:",
            opacitySliderLabelText: "🌧️ Adjust layer opacity:",
            animationInterval: 500,
            opacity: 0.5
        });
        rainviewer.addTo(map);


        //Call Mapbox 3D map
        function call3Dmap() {
            window.location.href = 'mapbox3D.html';
        }


        //Sea Level Rise//



        // Load the Lottie animation
        lottie.loadAnimation({
            container: document.getElementById('lottie-container'),
            renderer: 'svg',
            loop: true,
            autoplay: true,
            path: 'https://lottie.host/41453d5b-98f5-4478-ae32-24ffb6f5ff63/wN5fPgSl5x.json' // Lottie animation URL
        });











        /*
        // setup
        const data3 = {
          datasets: [
            {
              data: [15, 15, 15],
              backgroundColor: [
                "rgba(0, 123, 255, 0.8)",  // Blue for Low Temp
                "rgba(40, 167, 69, 0.8)",  // Green for Normal Temp
                "rgba(220, 53, 69, 0.8)",  // Red for High Temp
              ],
              needleValue: 30.5,
              borderColor: "white",
              borderWidth: 2,
              cutout: "90%",
              circumference: 180,
              rotation: 270,
            },
          ],
        };
        
        // gaugeNeedle plugin
        const gaugeNeedle3 = {
          id: "gaugeNeedle",
          afterDatasetDraw(chart, args, options) {
            const { ctx, config, data, chartArea: { top, bottom, left, right, width, height } } = chart;
            ctx.save();
            
            const needleValue = data.datasets[0].needleValue;
            const dataTotal = data.datasets[0].data.reduce((a, b) => a + b, 0);
            const angle = Math.PI + (1 / 45) * needleValue * Math.PI;
            
            const cx = width / 2;
            const cy = chart._metasets[0].data[0].y;
        
            // Draw needle
            ctx.translate(cx, cy);
            ctx.rotate(angle);
            ctx.beginPath();
            ctx.moveTo(0, -2);
            ctx.lineTo(height / 2, 0);  // Reduced needle length
            ctx.lineTo(0, 2);
            ctx.fillStyle = "#444";
            ctx.fill();
            
            // Draw needle dot
            ctx.translate(-cx, -cy);
            ctx.beginPath();
            ctx.arc(cx, cy, 5, 0, Math.PI * 2);
            ctx.fill();
            ctx.restore();
        
            // Add text
            ctx.font = "20px Arial";
            ctx.fillStyle = "#444";
            ctx.textAlign = "center";
            ctx.fillText(`${needleValue.toFixed(1)}°C`, cx, cy + 50);
            
        
        
        
            ctx.font = "12px 'Be Vietnam', sans-serif";
            ctx.fillText("0°C", left + 10, bottom);
            ctx.fillText("22.5°C", cx, bottom - height / 6);
            ctx.fillText("45°C", right - 10, bottom);
          },
        };
        
        // config
        const config3 = {
          type: "doughnut",
          data,
          options: {
            responsive: true,
            plugins: {
              legend: { display: false },
              tooltip: { enabled: false },
            },
          },
          plugins: [gaugeNeedle],
        };
        
        // render chart
        const myChart3 = new Chart(
          document.getElementById("temperatureGauge3"),
          config
        );
        
        
        
        
        
        // setup
        const data4 = {
          datasets: [
            {
              data: [15, 15, 15],
              backgroundColor: [
                "rgba(0, 123, 255, 0.8)",  // Blue for Low Temp
                "rgba(40, 167, 69, 0.8)",  // Green for Normal Temp
                "rgba(220, 53, 69, 0.8)",  // Red for High Temp
              ],
              needleValue: 30.5,
              borderColor: "white",
              borderWidth: 2,
              cutout: "90%",
              circumference: 180,
              rotation: 270,
            },
          ],
        };
        
        // gaugeNeedle plugin
        const gaugeNeedle4 = {
          id: "gaugeNeedle",
          afterDatasetDraw(chart, args, options) {
            const { ctx, config, data, chartArea: { top, bottom, left, right, width, height } } = chart;
            ctx.save();
            
            const needleValue = data.datasets[0].needleValue;
            const dataTotal = data.datasets[0].data.reduce((a, b) => a + b, 0);
            const angle = Math.PI + (1 / 45) * needleValue * Math.PI;
            
            const cx = width / 2;
            const cy = chart._metasets[0].data[0].y;
        
            // Draw needle
            ctx.translate(cx, cy);
            ctx.rotate(angle);
            ctx.beginPath();
            ctx.moveTo(0, -2);
            ctx.lineTo(height / 2, 0);  // Reduced needle length
            ctx.lineTo(0, 2);
            ctx.fillStyle = "#444";
            ctx.fill();
            
            // Draw needle dot
            ctx.translate(-cx, -cy);
            ctx.beginPath();
            ctx.arc(cx, cy, 5, 0, Math.PI * 2);
            ctx.fill();
            ctx.restore();
        
            // Add text
            ctx.font = "20px Arial";
            ctx.fillStyle = "#444";
            ctx.textAlign = "center";
            ctx.fillText(`${needleValue.toFixed(1)}°C`, cx, cy + 50);
            
        
        
        
            ctx.font = "12px 'Be Vietnam', sans-serif";
            ctx.fillText("0°C", left + 10, bottom);
            ctx.fillText("22.5°C", cx, bottom - height / 6);
            ctx.fillText("45°C", right - 10, bottom);
          },
        };
        
        // config
        const config4 = {
          type: "doughnut",
          data,
          options: {
            responsive: true,
            plugins: {
              legend: { display: false },
              tooltip: { enabled: false },
            },
          },
          plugins: [gaugeNeedle],
        };
        
        // render chart
        const myChart4 = new Chart(
          document.getElementById("temperatureGauge4"),
          config
        );
        */</script>